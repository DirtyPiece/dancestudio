<!--=======================================================================
// <copyright file="DanceStudio.Targets" company="Microsoft">
// Copyright 2014 Microsoft
// </copyright>
// <summary>
// A custom MSBuild target file that's included in all DanceStudio projects.
// </summary>
// =======================================================================-->

<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

  <!--
  =======================================================================
  Common Properties
  =======================================================================
  -->
  <PropertyGroup>
    <DanceStudioRepositoryRoot>$(MSBuildThisFileDirectory)..\..\</DanceStudioRepositoryRoot>
    <DanceStudioBuildFolderRoot>$(DanceStudioRepositoryRoot)Build\</DanceStudioBuildFolderRoot>
    <DanceStudioBuildToolsRoot>$(DanceStudioBuildFolderRoot)Tools\</DanceStudioBuildToolsRoot>
    <DanceStudioDoxygenExePath>$(DanceStudioBuildToolsRoot)Doxygen\Doxygen.exe</DanceStudioDoxygenExePath>
    <DanceStudioDoxygenConfigurationFilePath>$(DanceStudioBuildToolsRoot)Doxygen\Doxyfile</DanceStudioDoxygenConfigurationFilePath>
  </PropertyGroup>

  <!--
  =======================================================================
  Import StyleCop for code styling checking.
  =======================================================================
  -->

  <!--Treat StyleCop warnings as errors in release builds.-->
  <PropertyGroup Condition=" '$(Configuration)' == 'Release' ">
    <StyleCopTreatErrorsAsWarnings>false</StyleCopTreatErrorsAsWarnings>
  </PropertyGroup>

  <!--Enable StyleCop in all builds.-->
  <Import Project="$(DanceStudioBuildToolsRoot)StyleCop\StyleCop.Targets" />

  <!--
  =======================================================================
  Run Doxygen to generate the documentation for the source code.
  =======================================================================
  -->
  <Target Name="DanceStudioDoxygenTarget" AfterTargets="AfterBuild" Condition="'$(DanceStudioShouldRunDoxygen)' == 'true' AND '$(Configuration)' == 'Release'">
    <Message Importance="high" Text="Running Doxygen documentation generation against '$(DanceStudioBuildToolsRoot)Doxygen\Doxyfile'." />
    <Exec Command="$(DanceStudioDoxygenExePath) $(DanceStudioDoxygenConfigurationFilePath)" />
  </Target>
</Project>